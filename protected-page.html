<!DOCTYPE html>
<html>
<head>
	<title>Command Prompt</title>
	<style type="text/css">
		body {
			background-color: #1f1f1f;
			color: #fff;
			font-family: monospace;
			font-size: 14px;
			overflow: hidden;
		}

		#terminal {
			width: 100%;
			height: 100%;
			overflow: auto;
			padding: 10px;
			box-sizing: border-box;
		}

		#terminal:after {
			content: "$ ";
		}

		#terminal-input {
			outline: none;
			border: none;
			background-color: transparent;
			color: #fff;
			font-family: monospace;
			font-size: 14px;
			width: calc(100% - 20px);
			margin: 0;
			padding: 0;
			display: inline-block;
			vertical-align: bottom;
			line-height: 20px;
		}
	</style>
</head>
<body>
	<div id="terminal" contenteditable="true"></div>

	<script type="text/javascript">
		// Redirect user to login page if not logged in
		if (!sessionStorage.getItem("authenticated")) {
			window.location.href = "index.html";
		}

		document.getElementById("terminal").addEventListener("keydown", function(event) {
			if (event.keyCode === 13) {
				event.preventDefault();
				var input = document.createElement("div");
				input.textContent = "$ " + document.getElementById("terminal-input").textContent;
				document.getElementById("terminal").appendChild(input);
				document.getElementById("terminal-input").textContent = "";
				
				// Check if command exists in JSON file and send to server via AJAX
				var command = input.textContent.substr(2);
				var xhttp = new XMLHttpRequest();
				xhttp.onreadystatechange = function() {
					if (this.readyState == 4 && this.status == 200) {
						console.log(this.responseText);
					}
				};
				xhttp.open("POST", "server.py", true);
				xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
				xhttp.send("command=" + command);
			}
		});
	</script>
</body>
</html>

